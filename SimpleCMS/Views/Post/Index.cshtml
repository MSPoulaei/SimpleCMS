@model SimpleCMS.DataLayer.Post

@{
    ViewBag.Title = "Index";
}
@section CSS{
    <style>
        .mb-8px {
            margin-bottom: 8px;
        }
    </style>
}

<div class="row tm-row">
    <div class="col-12">
        <hr class="tm-hr-primary tm-mb-55">
        <!-- Video player 1422x800 -->
        <img src="~/images/@Model.ImageName" class="tm-mb-40" width="954" height="535">
    </div>
</div>
<div class="row tm-row">
    <div class="col-lg-8 tm-post-col">
        <div class="tm-post-full">
            <div class="mb-4">
                <h2 class="pt-2 tm-color-primary tm-post-title">@Model.Title</h2>
                @*<p class="tm-mb-40">June 16, 2020 posted by Admin Nat</p>*@
                <p class="mb-8px">
                    @{var first_subcat = true;
                        foreach (var subcat in @Model.SubCategories)
                        {
                            if (!first_subcat)
                            {
                                <span>, @subcat.Name</span>
                            }
                            else
                            {
                                <span>@subcat.Name</span>
                                first_subcat = false;
                            }
                        }
                    }
                </p>
                <p class="mb-8px">@( (ViewBag.PersianCalendar) ? Model.DateCreated.ToShamsiText(): Model.DateCreated.ToMiladiText() ) posted by <a href="/author/@Model.Author.AuthorId">@Model.Author.User.GetFullName()</a></p>
                <p class="tm-mb-40">Visits: @Model.VisitsCount</p>
                @if (ViewBag.ShowDescriptionInPost)
                {
                    <p>
                        @Model.Description
                    </p>
                }
                <p>
                    @Html.Raw(Model.Text)
                </p>
                @*<span class="d-block text-right tm-color-primary">Creative . Design . Business</span>*@
                <span class="d-block text-right tm-color-primary">
                    @{var first_tag = true;
                        foreach (var tag in Model.Tags.Split(','))
                        {
                            if (!first_tag)
                            {
                                <span>, <a href="/search?q=@tag">@tag</a></span>
                            }
                            else
                            {
                                <span><a href="/search?q=@tag">@tag</a></span>
                                first_tag = false;
                            }
                        }
                    }
                </span>
            </div>

            <!-- Comments -->
            <div>
                <h2 class="tm-color-primary tm-post-title">Comments</h2>
                <hr class="tm-hr-primary tm-mb-45">

                @foreach (var mainCommnet in Model.Comments)
                {
                    <div class="tm-comment tm-mb-45">
                        <figure class="tm-comment-figure">
                            <img src="/images/users/@mainCommnet.User.AvatarImageName" alt="Image" class="mb-2 rounded-circle img-thumbnail">
                            <figcaption class="tm-color-primary text-center">@mainCommnet.User.GetFullName()</figcaption>
                        </figure>
                        <div>
                            <h3>@mainCommnet.Title</h3>
                            <p>
                                @mainCommnet.Text
                            </p>
                            <div class="d-flex justify-content-between">
                                <a href="#" class="tm-color-primary">REPLY</a>
                                <span class="tm-color-primary">@( (ViewBag.PersianCalendar) ? mainCommnet.DateCreated.ToShamsiText(): mainCommnet.DateCreated.ToMiladiText() )</span>
                            </div>
                        </div>
                    </div>
                    foreach (var subComment in mainCommnet.SubComments)
                    {
                        <div class="tm-comment-reply tm-mb-45">
                            <hr>
                            <div class="tm-comment">
                                <figure class="tm-comment-figure">
                                    <img src="/images/users/@subComment.User.AvatarImageName" alt="Image" class="mb-2 rounded-circle img-thumbnail">
                                    <figcaption class="tm-color-primary text-center">@subComment.User.GetFullName()</figcaption>
                                </figure>
                                <div>
                                    <h3>@subComment.Title</h3>
                                    <p>
                                        @subComment.Text
                                    </p>
                                </div>
                            </div>
                            <span class="d-block text-right tm-color-primary">@( (ViewBag.PersianCalendar) ? subComment.DateCreated.ToShamsiText(): subComment.DateCreated.ToMiladiText())</span>


                        </div>
                    }
                }

                <form action="" class="mb-5 tm-comment-form">
                    <h2 class="tm-color-primary tm-post-title mb-4">Your comment</h2>
                    <div class="mb-4">
                        <label for="name">Name: </label>
                        <input id="name" class="form-control" name="name" type="text" placeholder="Your Name" required>
                    </div>
                    <div class="mb-4">
                        <label for="email">Email: </label>
                        <input id="email" class="form-control" name="email" type="email" placeholder="Your Email" required>
                    </div>
                    <div class="mb-4">
                        <label for="message">Message: </label>
                        <textarea id="message" class="form-control" name="message" rows="6" placeholder="Your Message" required></textarea>
                    </div>
                    <div class="text-right">
                        <button type="submit" class="tm-btn tm-btn-primary tm-btn-small">Submit</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
    <aside class="col-lg-4 tm-aside-col">
        <div class="tm-post-sidebar">
            <hr class="mb-3 tm-hr-primary">
            <h2 class="mb-4 tm-post-title tm-color-primary">Categories</h2>
            <ul class="tm-mb-75 pl-5 tm-category-list">
                @{Html.RenderAction("List", "Category");}
            </ul>
            <hr class="mb-3 tm-hr-primary">
            <h2 class="tm-mb-40 tm-post-title tm-color-primary">Related Posts</h2>
            @{Html.RenderAction("RelatedPosts");}
            @*@{Html.RenderAction("RelatedPosts","Post");}//both works *@
        </div>
    </aside>
</div>
